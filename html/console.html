<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Console</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="css/console.css">
    <link rel="stylesheet" href="font-awesome-4.6.1/css/font-awesome.min.css">
    <!--<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>-->
    <!--<script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>-->

    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="d3/d3.min.js" type="text/javascript"></script>

</head>
<body>
<nav class="navbar navbar-default" style="margin-bottom: 0;">
    <div class="container">
        <div class="navbar-header pull-left">
            <a href="console.html" class="navbar-brand"><i class="fa fa-area-chart" aria-hidden="true"></i>&nbsp; Console</a>
        </div>
        <div class="navbar-header pull-right">
            <ul class="nav navbar-nav">
                <li>
                    <a href="#"><i class="fa fa-bell" aria-hidden="true"></i>&nbsp; feedback<span class="badge">42</span> </a>
                </li>
                <li>
                    <a href="#"> feedback<span class="badge">42</span> </a>
                </li>
            </ul>
        </div>
    </div>
</nav>
<div class="container-fluid">
    <div class="row" style="background-color:#f5f5f5;">
        <div class="col-sm-3 col-md-2 sidebar">
            <ul class="nav" >
                <li>
                    <a href="#menu_condition" data-toggle="collapse"> <i class="fa fa-eye" aria-hidden="true"></i>&nbsp;  Monitor</a>
                    <ul id="menu_condition" class="nav second-menu collapse in">
                        <li><a href="#"><i class="fa fa-car" aria-hidden="true"></i>&nbsp; parking</a></li>
                        <li><a href="show-reservation.html"><i class="fa fa-pencil-square-o" aria-hidden="true"></i>&nbsp; reservation</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#menu_business" data-toggle="collapse" class="collapsed"><i class="fa fa-pie-chart" aria-hidden="true"></i>&nbsp; Business</a>
                    <ul id="menu_business" class="nav second-menu collapse">
                        <li><a href="#"><i class="fa fa-usd" aria-hidden="true"></i>&nbsp; price</a></li>
                        <li><a href="#"><i class="fa fa-bullhorn" aria-hidden="true"></i>&nbsp; promotion</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#menu_user" data-toggle="collapse" class="collapsed"><i class="fa fa-users" aria-hidden="true"></i>&nbsp; Users</a>
                    <ul id="menu_user" class="nav second-menu collapse">
                        <li><a href="#"><i class="fa fa-tag" aria-hidden="true"></i>&nbsp;classify</a></li>
                        <li><a href="#"><i class="fa fa-percent" aria-hidden="true"></i>&nbsp;distribution</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="col-sm-9 col-md-10" style="background-color: white">
            <h1 ><span class=" label label-default">State</span></h1>
            <div id="svg-state" style="margin-top:20px;margin-left:100px;margin-bottom:30px;float:left;border:1px black solid;background: #eee">
            </div>
            <script>
                height=500;
                width=800;
                var svg=d3.select("#svg-state")
                        .append("svg")
                        .attr("height",height)
                        .attr("width",width);
                var str='[{"pid":301,"state":"occupied"},{"pid":301,"state":"occupied"},{"pid":301,"state":"occupied"},{"pid":301,"state":"occupied"},{"pid":301,"state":"occupied"},{"pid":301,"state":"occupied"},{"pid":302,"state":"idle"},{"pid":302,"state":"idle"},{"pid":302,"state":"idle"},{"pid":302,"state":"idle"},{"pid":303,"state":"empty"}]';
                var dataSet=JSON.parse(str);
                var num_col=4;
                var num_row=Math.ceil(dataSet.length/4);
                var padding = {left:20, right:20, top:20, bottom:20};
                var linearx=d3.scale.linear()
                        .domain([0,num_col])
                        .range([0,width-padding.left-padding.right]);
                var lineary=d3.scale.linear()
                        .domain([0,num_row])
                        .range([0,height - padding.top - padding.bottom]);
                var rectHeight=lineary(2)-lineary(1);
                var rectWidth=linearx(2)-linearx(1);
                var rectPadding=10;
                svg.selectAll("rect")
                        .data(dataSet)
                        .enter()
                        .append("rect")
                        .attr("stroke","black")
                        .attr("stroke-width","1")
                        .attr("stroke-linecap","round")
                        .attr("stroke-linejoin","round")
                        .attr("transform","translate(" + padding.left + "," + padding.top + ")")
                        .attr("x",function(d,i){
                            return linearx(i%num_col);
                        })
                        .attr("y",function(d,i){
                            return lineary(Math.floor(i/num_col));
                        })
                        .attr("width",rectWidth-rectPadding)
                        .attr("height",rectHeight-rectPadding)
                        .attr("fill",function(d,i){
                            if(d.state=="occupied"){
                                return "steelblue"
                            }
                            else if(d.state=="idle"){
                                return "yellow";
                            }
                            else if(d.state=="empty"){
                                return "white";
                            }
                        });
                var texts = svg.selectAll(".MyText")
                        .data(dataSet)
                        .enter()
                        .append("text")
                        .attr("class","MyText")
                        .attr("transform","translate(" + padding.left + "," + padding.top + ")")
                        .attr("x", function(d,i){
                            return linearx(i%num_col);
                        } )
                        .attr("y",function(d,i){
                            return lineary(Math.floor(i/num_col));
                        })
                        .attr("dx",function(){
                            return (rectWidth-rectPadding)/3;
                        })
                        .attr("dy",function(d){
                            return (rectHeight-rectPadding)/2;
                        })
                        .text(function(d,i){
                            return d.pid+":"+ d.state;
                        });
            </script>
        </div>
    </div>

</div>
</body>
</html>